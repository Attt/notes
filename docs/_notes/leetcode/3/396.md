[396. æ—‹è½¬å‡½æ•°](https://leetcode.cn/problems/rotate-function/)

### æ€è·¯
æœ´ç´ çš„åšæ³•æ˜¯éå†è®¡ç®—ç„¶åæ¯”å¤§å°ï¼Œæ—¶é—´å¤æ‚åº¦O(n^2)ã€‚

è¿™ç§é¢˜ç›®å¦‚æœè¦ä¼˜åŒ–åˆ°O(n)æˆ–è€…O(logn)ï¼Œå¤§æ¦‚ç‡æ˜¯è¦åœ¨éå†çš„æ—¶å€™åˆ©ç”¨ä¸Šä¸€æ¬¡éå†çš„ç»“æœçš„ï¼Œå› æ­¤å¯¹äºæ­¤é¢˜å¯ä»¥å°è¯•æ‰¾ä¸€ä¸‹è§„å¾‹ï¼Œçœ‹ä¸€ä¸‹ç›¸é‚»çš„éå†æ­¥éª¤çš„ç»“æœæœ‰ä»€ä¹ˆå…³è”ã€‚

ä»¥é¢˜ç›®ä¾‹1çš„æ•°æ®ä¸ºğŸŒ°ï¼š

![](./396.drawio.svg)

å¯ä»¥å‘ç°
1. æ¯æ¬¡å‰è¿›çš„æ—¶å€™éƒ½æœ‰ä¸€éƒ¨åˆ†å…ƒç´ ç³»æ•°+1ï¼Œå¦‚æœå…¨éƒ¨å…ƒç´ ç³»æ•°+1ä»£è¡¨æ•´ä½“å¢åŠ äº†1 * sum
2. æ¯æ¬¡ç³»æ•°å¢åŠ 1çš„æ•°éƒ½æ˜¯é™¤æ‰å½“å‰èµ·ç‚¹içš„å…¶ä»–æ•°ï¼Œé‚£ä¹Ÿå°±æ˜¯å¢åŠ äº†sum - nums[i]
3. å½“å‰èµ·ç‚¹içš„æ•°çš„ç³»æ•°ä¸º0ï¼Œè€Œåœ¨å‰ä¸€æ¬¡è¯¥å…ƒç´ çš„ç³»æ•°åº”è¯¥æ˜¯æœ€å¤§çš„ï¼Œæ¯æ¬¡æœ€å¤§ç³»æ•°æ˜¯n - 1ï¼Œä¹Ÿå°±æ˜¯åœ¨èµ·ç‚¹ä¸Šï¼Œæ¯æ¬¡éƒ½ä¼šå‡å°‘(n - 1) * nums[i]

è®¾å½“å‰çš„èµ·å§‹åæ ‡ä¸ºiï¼Œä¸Šä¸€æ¬¡çš„å‡½æ•°å€¼ä¸ºpï¼Œå…ƒç´ æ•°é‡nï¼Œæ‰€æœ‰å…ƒç´ çš„å’Œä¸ºsumï¼Œé‚£ä¹ˆå°±æœ‰ï¼š

```text
å½“å‰çš„å‡½æ•°å€¼c = p + (sum - nums[i]) - (n - 1) * nums[i]
å³ 
    c = p + sum - n * nums[i]
```

### è§£
```java
class Solution {
    public int maxRotateFunction(int[] nums) {
        int ans = func(nums, 0), sum = 0, prev = ans, n = nums.length;
        if(n == 1) return ans;
        for(int i = 0; i < n; i++){
            sum += nums[i];
        }

        // cur = prev + (sum - first) - ((n - 1) * first)
        //     = prev + sum - n * first
        for(int i = n - 1; i > 0; i--){
            int cur = prev + sum - n * nums[i];
            ans = Math.max(cur, ans);
            prev = cur;
        }

        return ans;
    }

    private int func(int[] nums, int f){
        int n = nums.length, ans = 0;
        for(int i = 0; i < n; i++){
            ans += (nums[(f + i) % n] * i);
        }
        return ans;
    }

}
```